@echo off

call "%~dp0..\..\..\env.bat"

rem :: https://watch.cbc.ca/season/being-erica/season-3/bc87f52e-8d27-4699-b72c-62272551600b

call :cd "%~dp0.\Season 3"

call :dl "01. The Rabbit Hole.video.mp4"          "https://cbcvott-a.akamaihd.net/p//38e815a-00b460514ca/CBC_BEING_ERICA_SEASON_03_S03E01-v2-11179340/segments/CBC_BEING_ERICA_SEASON_03_S03E01_v7/prog_index.m3u8"
call :dl "01. The Rabbit Hole.audio.aac"          "https://cbcvott-a.akamaihd.net/p//38e815a-00b460514ca/CBC_BEING_ERICA_SEASON_03_S03E01-v2-11179340/segments/CBC_BEING_ERICA_SEASON_03_S03E01_a7/prog_index.m3u8"
call :mx "01. The Rabbit Hole"

call :dl "02. Moving On Up.video.mp4"             "https://cbcvott-a.akamaihd.net/p//38e815a-00b460624a9/CBC_BEING_ERICA_SEASON_03_S03E02-v2-11179390/segments/CBC_BEING_ERICA_SEASON_03_S03E02_v7/prog_index.m3u8"
call :dl "02. Moving On Up.audio.aac"             "https://cbcvott-a.akamaihd.net/p//38e815a-00b460624a9/CBC_BEING_ERICA_SEASON_03_S03E02-v2-11179390/segments/CBC_BEING_ERICA_SEASON_03_S03E02_a7/prog_index.m3u8"
call :mx "02. Moving On Up"

call :dl "03. Two Wrongs.video.mp4"               "https://cbcvott-a.akamaihd.net/p//38e815a-00b460a0ebb/CBC_BEING_ERICA_SEASON_03_S03E03-v2-11179792/segments/CBC_BEING_ERICA_SEASON_03_S03E03_v7/prog_index.m3u8"
call :dl "03. Two Wrongs.audio.aac"               "https://cbcvott-a.akamaihd.net/p//38e815a-00b460a0ebb/CBC_BEING_ERICA_SEASON_03_S03E03-v2-11179792/segments/CBC_BEING_ERICA_SEASON_03_S03E03_a7/prog_index.m3u8"
call :mx "03. Two Wrongs"

call :dl "04. Wash, Rinse, REPEAT.video.mp4"      "https://cbcvott-a.akamaihd.net/p//38e815a-00b461707b9/CBC_BEING_ERICA_SEASON_03_S03E04-v2-11180663/segments/CBC_BEING_ERICA_SEASON_03_S03E04_v7/prog_index.m3u8"
call :dl "04. Wash, Rinse, REPEAT.audio.aac"      "https://cbcvott-a.akamaihd.net/p//38e815a-00b461707b9/CBC_BEING_ERICA_SEASON_03_S03E04-v2-11180663/segments/CBC_BEING_ERICA_SEASON_03_S03E04_a7/prog_index.m3u8"
call :mx "04. Wash, Rinse, REPEAT"

call :dl "05. Being Adam.video.mp4"               "https://cbcvott-a.akamaihd.net/p//38e815a-00b4609d546/CBC_BEING_ERICA_SEASON_03_S03E05-v2-11179656/segments/CBC_BEING_ERICA_SEASON_03_S03E05_v7/prog_index.m3u8"
call :dl "05. Being Adam.audio.aac"               "https://cbcvott-a.akamaihd.net/p//38e815a-00b4609d546/CBC_BEING_ERICA_SEASON_03_S03E05-v2-11179656/segments/CBC_BEING_ERICA_SEASON_03_S03E05_a7/prog_index.m3u8"
call :mx "05. Being Adam"

call :dl "06. Bear Breasts.video.mp4"             "https://cbcvott-a.akamaihd.net/p//38e815a-00b4608c567/CBC_BEING_ERICA_SEASON_03_S03E06-v2-11179575/segments/CBC_BEING_ERICA_SEASON_03_S03E06_v7/prog_index.m3u8"
call :dl "06. Bear Breasts.audio.aac"             "https://cbcvott-a.akamaihd.net/p//38e815a-00b4608c567/CBC_BEING_ERICA_SEASON_03_S03E06-v2-11179575/segments/CBC_BEING_ERICA_SEASON_03_S03E06_a7/prog_index.m3u8"
call :mx "06. Bear Breasts"

call :dl "07. Jenny From the Block.video.mp4"     "https://cbcvott-a.akamaihd.net/p//38e815a-00b4613473d/CBC_BEING_ERICA_SEASON_03_S03E07-v2-11180500/segments/CBC_BEING_ERICA_SEASON_03_S03E07_v7/prog_index.m3u8"
call :dl "07. Jenny From the Block.audio.aac"     "https://cbcvott-a.akamaihd.net/p//38e815a-00b4613473d/CBC_BEING_ERICA_SEASON_03_S03E07-v2-11180500/segments/CBC_BEING_ERICA_SEASON_03_S03E07_a7/prog_index.m3u8"
call :mx "07. Jenny From the Block"

call :dl "08. Physician, Heal Thyself.video.mp4"  "https://cbcvott-a.akamaihd.net/p//38e815a-00b460e4e3f/CBC_BEING_ERICA_SEASON_03_S03E08-v2-11180065/segments/CBC_BEING_ERICA_SEASON_03_S03E08_v7/prog_index.m3u8"
call :dl "08. Physician, Heal Thyself.audio.aac"  "https://cbcvott-a.akamaihd.net/p//38e815a-00b460e4e3f/CBC_BEING_ERICA_SEASON_03_S03E08-v2-11180065/segments/CBC_BEING_ERICA_SEASON_03_S03E08_a7/prog_index.m3u8"
call :mx "08. Physician, Heal Thyself"

call :dl "09. Gettin' Wiggy Wit' It.video.mp4"    "https://cbcvott-a.akamaihd.net/p//38e815a-00b4642a8e9/CBC_BEING_ERICA_SEASON_03_S03E09-v2-11182144/segments/CBC_BEING_ERICA_SEASON_03_S03E09_v7/prog_index.m3u8"
call :dl "09. Gettin' Wiggy Wit' It.audio.aac"    "https://cbcvott-a.akamaihd.net/p//38e815a-00b4642a8e9/CBC_BEING_ERICA_SEASON_03_S03E09-v2-11182144/segments/CBC_BEING_ERICA_SEASON_03_S03E09_a7/prog_index.m3u8"
call :mx "09. Gettin' Wiggy Wit' It"

call :dl "10. The Tribe Has Spoken.video.mp4"     "https://cbcvott-a.akamaihd.net/p//38e815a-00b46246289/CBC_BEING_ERICA_SEASON_03_S03E10-v2-11181222/segments/CBC_BEING_ERICA_SEASON_03_S03E10_v7/prog_index.m3u8"
call :dl "10. The Tribe Has Spoken.audio.aac"     "https://cbcvott-a.akamaihd.net/p//38e815a-00b46246289/CBC_BEING_ERICA_SEASON_03_S03E10-v2-11181222/segments/CBC_BEING_ERICA_SEASON_03_S03E10_a7/prog_index.m3u8"
call :mx "10. The Tribe Has Spoken"

call :dl "11. Adam's Family.video.mp4"            "https://cbcvott-a.akamaihd.net/p//38e815a-00b4619e677/CBC_BEING_ERICA_SEASON_03_S03E11-v2-11180748/segments/CBC_BEING_ERICA_SEASON_03_S03E11_v7/prog_index.m3u8"
call :dl "11. Adam's Family.audio.aac"            "https://cbcvott-a.akamaihd.net/p//38e815a-00b4619e677/CBC_BEING_ERICA_SEASON_03_S03E11-v2-11180748/segments/CBC_BEING_ERICA_SEASON_03_S03E11_a7/prog_index.m3u8"
call :mx "11. Adam's Family"

call :dl "12. Erica, Interrupted.video.mp4"       "https://cbcvott-a.akamaihd.net/p//38e815a-00b460c2ef9/CBC_BEING_ERICA_SEASON_03_S03E12-v2-11179853/segments/CBC_BEING_ERICA_SEASON_03_S03E12_v7/prog_index.m3u8"
call :dl "12. Erica, Interrupted.audio.aac"       "https://cbcvott-a.akamaihd.net/p//38e815a-00b460c2ef9/CBC_BEING_ERICA_SEASON_03_S03E12-v2-11179853/segments/CBC_BEING_ERICA_SEASON_03_S03E12_a7/prog_index.m3u8"
call :mx "12. Erica, Interrupted"

call :dl "13. Fa La Erica.video.mp4"              "https://cbcvott-a.akamaihd.net/p//38e815a-00b4739b725/CBC_BEING_ERICA_SEASON_03_S03E13-v2-11192342/segments/CBC_BEING_ERICA_SEASON_03_S03E13_v7/prog_index.m3u8"
call :dl "13. Fa La Erica.audio.aac"              "https://cbcvott-a.akamaihd.net/p//38e815a-00b4739b725/CBC_BEING_ERICA_SEASON_03_S03E13-v2-11192342/segments/CBC_BEING_ERICA_SEASON_03_S03E13_a7/prog_index.m3u8"
call :mx "13. Fa La Erica"

goto done

:cd
  set dirname="%~1"
  if not exist %dirname% mkdir %dirname%
  cd %dirname%
  goto :eof

:dl
  set filename=%~1
  set m3u8_url=%~2
  if not exist "%cd%\%filename%" ffmpeg -i "%m3u8_url%" -c copy -bsf:a aac_adtstoasc "%filename%"
  goto :eof

:mx
  set filename=%~1
  set in_video="%cd%\%filename%.video.mp4"
  set in_audio="%cd%\%filename%.audio.aac"
  set out_muxd="%cd%\%filename%.mp4"
  if exist %in_video% if exist %in_audio% if not exist %out_muxd% ffmpeg -i %in_video% -i %in_audio% -c copy -bsf:a aac_adtstoasc -strict experimental %out_muxd%
  if exist %out_muxd% if exist %in_video% del %in_video%
  if exist %out_muxd% if exist %in_audio% del %in_audio%
  goto :eof

:done
  echo.
  echo all downloads are complete!
  echo.
  pause
