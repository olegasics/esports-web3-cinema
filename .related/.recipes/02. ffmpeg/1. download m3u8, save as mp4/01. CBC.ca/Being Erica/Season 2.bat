@echo off

call "%~dp0..\..\..\env.bat"

rem :: https://watch.cbc.ca/season/being-erica/season-2/2b1aed29-a789-4284-b012-f33307c7aaf7

call :cd "%~dp0.\Season 2"

call :dl "01. Being Dr. Tom.video.mp4"            "https://cbcvott-a.akamaihd.net/p//38e815a-00ad0e90d45//CBC_BEING_ERICA_SEASON_02_S02E01-v2-10427261/segments/CBC_BEING_ERICA_SEASON_02_S02E01_v7/prog_index.m3u8"
call :dl "01. Being Dr. Tom.audio.aac"            "https://cbcvott-a.akamaihd.net/p//38e815a-00ad0e90d45//CBC_BEING_ERICA_SEASON_02_S02E01-v2-10427261/segments/CBC_BEING_ERICA_SEASON_02_S02E01_a7/prog_index.m3u8"
call :mx "01. Being Dr. Tom"

call :dl "02. Battle Royale.video.mp4"            "https://cbcvott-a.akamaihd.net/p//38e815a-00ad0dea50d//CBC_BEING_ERICA_SEASON_02_S02E02-v2-10426716/segments/CBC_BEING_ERICA_SEASON_02_S02E02_v7/prog_index.m3u8"
call :dl "02. Battle Royale.audio.aac"            "https://cbcvott-a.akamaihd.net/p//38e815a-00ad0dea50d//CBC_BEING_ERICA_SEASON_02_S02E02-v2-10426716/segments/CBC_BEING_ERICA_SEASON_02_S02E02_a7/prog_index.m3u8"
call :mx "02. Battle Royale"

call :dl "03. Mama Mia.video.mp4"                 "https://cbcvott-a.akamaihd.net/p//38e815a-00ad0b884f3//CBC_BEING_ERICA_SEASON_02_S02E03-v2-10425437/segments/CBC_BEING_ERICA_SEASON_02_S02E03_v7/prog_index.m3u8"
call :dl "03. Mama Mia.audio.aac"                 "https://cbcvott-a.akamaihd.net/p//38e815a-00ad0b884f3//CBC_BEING_ERICA_SEASON_02_S02E03-v2-10425437/segments/CBC_BEING_ERICA_SEASON_02_S02E03_a7/prog_index.m3u8"
call :mx "03. Mama Mia"

call :dl "04. Cultural Revolution.video.mp4"      "https://cbcvott-a.akamaihd.net/p//38e815a-00ad0ed861d//CBC_BEING_ERICA_SEASON_02_S02E04-v2-10427305/segments/CBC_BEING_ERICA_SEASON_02_S02E04_v7/prog_index.m3u8"
call :dl "04. Cultural Revolution.audio.aac"      "https://cbcvott-a.akamaihd.net/p//38e815a-00ad0ed861d//CBC_BEING_ERICA_SEASON_02_S02E04-v2-10427305/segments/CBC_BEING_ERICA_SEASON_02_S02E04_a7/prog_index.m3u8"
call :mx "04. Cultural Revolution"

call :dl "05. Yes We Can.video.mp4"               "https://cbcvott-a.akamaihd.net/p//38e815a-00ad0bf3fc8//CBC_BEING_ERICA_SEASON_02_S02E05-v2-10425530/segments/CBC_BEING_ERICA_SEASON_02_S02E05_v7/prog_index.m3u8"
call :dl "05. Yes We Can.audio.aac"               "https://cbcvott-a.akamaihd.net/p//38e815a-00ad0bf3fc8//CBC_BEING_ERICA_SEASON_02_S02E05-v2-10425530/segments/CBC_BEING_ERICA_SEASON_02_S02E05_a7/prog_index.m3u8"
call :mx "05. Yes We Can"

call :dl "06. Shhh... Don't Tell.video.mp4"       "https://cbcvott-a.akamaihd.net/p//38e815a-00ad0c7462d//CBC_BEING_ERICA_SEASON_02_S02E06-v2-10425729/segments/CBC_BEING_ERICA_SEASON_02_S02E06_v7/prog_index.m3u8"
call :dl "06. Shhh... Don't Tell.audio.aac"       "https://cbcvott-a.akamaihd.net/p//38e815a-00ad0c7462d//CBC_BEING_ERICA_SEASON_02_S02E06-v2-10425729/segments/CBC_BEING_ERICA_SEASON_02_S02E06_a7/prog_index.m3u8"
call :mx "06. Shhh... Don't Tell"

call :dl "07. The Unkindest Cut.video.mp4"        "https://cbcvott-a.akamaihd.net/p//38e815a-00ad0e4dce8//CBC_BEING_ERICA_SEASON_02_S02E07-v2-10427009/segments/CBC_BEING_ERICA_SEASON_02_S02E07_v7/prog_index.m3u8"
call :dl "07. The Unkindest Cut.audio.aac"        "https://cbcvott-a.akamaihd.net/p//38e815a-00ad0e4dce8//CBC_BEING_ERICA_SEASON_02_S02E07-v2-10427009/segments/CBC_BEING_ERICA_SEASON_02_S02E07_a7/prog_index.m3u8"
call :mx "07. The Unkindest Cut"

call :dl "08. Under My Thumb.video.mp4"           "https://cbcvott-a.akamaihd.net/p//38e815a-00ad0efa65f//CBC_BEING_ERICA_SEASON_02_S02E08-v2-10427775/segments/CBC_BEING_ERICA_SEASON_02_S02E08_v7/prog_index.m3u8"
call :dl "08. Under My Thumb.audio.aac"           "https://cbcvott-a.akamaihd.net/p//38e815a-00ad0efa65f//CBC_BEING_ERICA_SEASON_02_S02E08-v2-10427775/segments/CBC_BEING_ERICA_SEASON_02_S02E08_a7/prog_index.m3u8"
call :mx "08. Under My Thumb"

call :dl "09. A River Runs Through It... It Being Egypt.video.mp4"    "https://cbcvott-a.akamaihd.net/p//38e815a-00ad0ee963c//CBC_BEING_ERICA_SEASON_02_S02E09-v2-10427417/segments/CBC_BEING_ERICA_SEASON_02_S02E09_v7/prog_index.m3u8"
call :dl "09. A River Runs Through It... It Being Egypt.audio.aac"    "https://cbcvott-a.akamaihd.net/p//38e815a-00ad0ee963c//CBC_BEING_ERICA_SEASON_02_S02E09-v2-10427417/segments/CBC_BEING_ERICA_SEASON_02_S02E09_a7/prog_index.m3u8"
call :mx "09. A River Runs Through It... It Being Egypt"

call :dl "10. Papa Can You Hear Me.video.mp4"                         "https://cbcvott-a.akamaihd.net/p//38e815a-00ad0cc5c5c//CBC_BEING_ERICA_SEASON_02_S02E10-v2-10425801/segments/CBC_BEING_ERICA_SEASON_02_S02E10_v7/prog_index.m3u8"
call :dl "10. Papa Can You Hear Me.audio.aac"                         "https://cbcvott-a.akamaihd.net/p//38e815a-00ad0cc5c5c//CBC_BEING_ERICA_SEASON_02_S02E10-v2-10425801/segments/CBC_BEING_ERICA_SEASON_02_S02E10_a7/prog_index.m3u8"
call :mx "10. Papa Can You Hear Me"

call :dl "11. What Goes Up Must Come Down.video.mp4"                  "https://cbcvott-a.akamaihd.net/p//38e815a-00ad171d3a0//CBC_BEING_ERICA_SEASON_02_S02E11-v2-10431194/segments/CBC_BEING_ERICA_SEASON_02_S02E11_v7/prog_index.m3u8"
call :dl "11. What Goes Up Must Come Down.audio.aac"                  "https://cbcvott-a.akamaihd.net/p//38e815a-00ad171d3a0//CBC_BEING_ERICA_SEASON_02_S02E11-v2-10431194/segments/CBC_BEING_ERICA_SEASON_02_S02E11_a7/prog_index.m3u8"
call :mx "11. What Goes Up Must Come Down"

call :dl "12. The Importance of Being Erica.video.mp4"                "https://cbcvott-a.akamaihd.net/p//38e815a-00ad0e7ec8b//CBC_BEING_ERICA_SEASON_02_S02E12-v2-10427220/segments/CBC_BEING_ERICA_SEASON_02_S02E12_v7/prog_index.m3u8"
call :dl "12. The Importance of Being Erica.audio.aac"                "https://cbcvott-a.akamaihd.net/p//38e815a-00ad0e7ec8b//CBC_BEING_ERICA_SEASON_02_S02E12-v2-10427220/segments/CBC_BEING_ERICA_SEASON_02_S02E12_a7/prog_index.m3u8"
call :mx "12. The Importance of Being Erica"

goto done

:cd
  set dirname="%~1"
  if not exist %dirname% mkdir %dirname%
  cd %dirname%
  goto :eof

:dl
  set filename=%~1
  set m3u8_url=%~2
  if not exist "%cd%\%filename%" ffmpeg -i "%m3u8_url%" -c copy -bsf:a aac_adtstoasc "%filename%"
  goto :eof

:mx
  set filename=%~1
  set in_video="%cd%\%filename%.video.mp4"
  set in_audio="%cd%\%filename%.audio.aac"
  set out_muxd="%cd%\%filename%.mp4"
  if exist %in_video% if exist %in_audio% if not exist %out_muxd% ffmpeg -i %in_video% -i %in_audio% -c copy -bsf:a aac_adtstoasc -strict experimental %out_muxd%
  if exist %out_muxd% if exist %in_video% del %in_video%
  if exist %out_muxd% if exist %in_audio% del %in_audio%
  goto :eof

:done
  echo.
  echo all downloads are complete!
  echo.
  pause
